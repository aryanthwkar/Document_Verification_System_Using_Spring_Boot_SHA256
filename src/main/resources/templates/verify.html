<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verify Documents - Verification System</title>
    <style>
                /* ‚Äî‚Äî‚Äî your existing CSS unchanged ‚Äî‚Äî‚Äî */
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #34495e;
            --accent-color: #3498db;
            --success-color: #27ae60;
            --warning-color: #e74c3c;
            --light-bg: #ecf0f1;
            --text-dark: #2c3e50;
            --text-light: #7f8c8d;
            --white: #ffffff;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --border-radius: 8px;
        }
        * { margin:0; padding:0; box-sizing:border-box; }
        body { font-family:'Segoe UI',system-ui; background:var(--light-bg); min-height:100vh; padding:2rem; }
        .header{ max-width:800px; margin:0 auto 2rem; }
        .back-button{ display:inline-flex; align-items:center; gap:.5rem; padding:.75rem 1.5rem; background:var(--white); color:var(--primary-color); text-decoration:none; border-radius:var(--border-radius); font-weight:500; margin-bottom:1.5rem; transition:.3s; border:1px solid #ddd;}
        .back-button:hover{ background:var(--primary-color); color:var(--white);}
        .page-title{ color:var(--primary-color); font-size:2rem; margin-bottom:.5rem; font-weight:600;}
        .page-subtitle{ color:var(--text-light); font-size:1rem;}
        .verify-card{ background:var(--white); border-radius:12px; padding:2.5rem; box-shadow:var(--shadow); max-width:800px; margin:0 auto;}
        .verify-area{ border:2px dashed #bdc3c7; border-radius:var(--border-radius); padding:3rem 2rem; text-align:center; margin-bottom:2rem; transition:.3s; cursor:pointer; background:var(--light-bg);}
        .verify-area:hover,.verify-area.dragover{ border-color:var(--accent-color); background:#e8f4fd;}
        .verify-icon{ font-size:3rem; color:var(--accent-color); margin-bottom:1rem;}
        .verify-text{ color:var(--text-dark); font-size:1.25rem; margin-bottom:.5rem; font-weight:500;}
        .verify-subtext{ color:var(--text-light); margin-bottom:1.5rem;}
        .file-input{ display:none;}
        .browse-button{ display:inline-block; padding:.75rem 1.5rem; background:var(--accent-color); color:var(--white); border:none; border-radius:var(--border-radius); font-size:.9rem; font-weight:500; cursor:pointer; transition:.3s;}
        .browse-button:hover{ background:#2980b9; transform:translateY(-1px);}
        .verify-button{ width:100%; padding:1rem; background:var(--accent-color); color:var(--white); border:none; border-radius:var(--border-radius); font-size:1rem; font-weight:600; cursor:pointer; transition:.3s;}
        .verify-button:hover:not(:disabled){ background:#2980b9; transform:translateY(-1px);}
        .verify-button:disabled{ background:#bdc3c7; cursor:not-allowed;}
        .result-card{ margin-top:2rem; padding:2rem; border-radius:var(--border-radius); border-left:6px solid var(--accent-color);}
        .result-success{ background:#d4edda; border-left-color:var(--success-color);}
        .result-error{ background:#f8d7da; border-left-color:var(--warning-color);}
        .result-icon{ font-size:3rem; margin-bottom:1rem;}
        .result-title{ font-size:1.5rem; font-weight:600; margin-bottom:1rem;}
        .result-success .result-title{ color:#155724;}
        .result-error .result-title{ color:#721c24;}
        .document-details{ background:var(--white); border-radius:var(--border-radius); padding:1.5rem; margin-top:1.5rem;}
        .detail-row{ display:flex; justify-content:space-between; padding:.75rem 0; border-bottom:1px solid #eee;}
        .detail-row:last-child{ border-bottom:none;}
        .detail-label{ font-weight:600; color:var(--text-dark);}
        .detail-value{ color:var(--text-light); font-family:'Courier New',monospace;}
        .verification-key{ background:var(--primary-color); color:var(--white); padding:.5rem 1rem; border-radius:4px; font-family:'Courier New',monospace; font-weight:600; display:inline-block; margin-top:.5rem;}
        .file-info{ margin-top:1.5rem; padding:1.5rem; background:#f8f9fa; border-radius:var(--border-radius); border-left:4px solid var(--accent-color);}
        .selected-file{ margin-top:1rem; padding:1rem; background:var(--white); border-radius:6px; border-left:4px solid var(--success-color); display:flex; justify-content:space-between; align-items:center;}
        .file-details{ flex-grow:1;}
        .file-name{ font-weight:600; color:var(--text-dark);}
        .file-size{ color:var(--text-light); font-size:.875rem;}
    </style>
</head>
<body>
    <div class="header">
        <a href="/" class="back-button">‚Üê Back to Dashboard</a>
        <h1 class="page-title">Verify Documents</h1>
        <p class="page-subtitle">Upload document to automatically verify its authenticity</p>
    </div>

    <div class="verify-card">
        <form th:action="@{/verify}" method="post" enctype="multipart/form-data" id="verifyForm">
            <div class="verify-area" id="verifyArea">
                <div class="verify-icon">üîç</div>
                <div class="verify-text">Select document to verify</div>
                <div class="verify-subtext">Drag & drop file or click to browse</div>
                <div class="verify-subtext" style="font-size:0.875rem;margin-top:0.5rem;">
                    System will automatically check against verification database
                </div>
                <input type="file" id="fileInput" name="file" class="file-input" accept=".pdf,.jpg,.jpeg,.png,.doc,.docx" onchange="displayFileInfo()">
                <button type="button" class="browse-button" onclick="document.getElementById('fileInput').click()">Browse File</button>
            </div>

            <div id="fileInfo" class="file-info" style="display:none;">
                <strong>Selected File:</strong>
                <div id="selectedFiles"></div>
            </div>

            <button type="submit" class="verify-button" id="verifyButton" disabled>Verify Document</button>
        </form>

        <!-- Verification Result -->
        <div th:if="${verificationResult}" 
             th:classappend="${verificationResult.verified} ? 'result-success' : 'result-error'" 
             class="result-card">
             
            <div class="result-icon" th:text="${verificationResult.verified} ? '‚úÖ' : '‚ùå'"></div>
            <div class="result-title" th:text="${verificationResult.message}"></div>
            
            <!-- ‚úÖ Corrected conditional -->
            <div th:if="${verificationResult.verified and verificationResult.document != null}" class="document-details">
                <div class="detail-row">
                    <span class="detail-label">File Name:</span>
                    <span class="detail-value" th:text="${verificationResult.document.fileName}"></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Verification Key:</span>
                    <span class="detail-value" th:text="${verificationResult.document.uniqueKey}"></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Upload Date:</span>
                    <span class="detail-value" th:text="${#temporals.format(verificationResult.document.uploadTime, 'yyyy-MM-dd HH:mm:ss')}"></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Document ID:</span>
                    <span class="detail-value" th:text="${verificationResult.document.id}"></span>
                </div>
                <div class="verification-key">
                    Key Used: <span th:text="${verificationResult.verificationKey}"></span>
                </div>
            </div>
        </div>
    </div>

    <script>
        function displayFileInfo() {
            const fileInput = document.getElementById('fileInput');
            const fileInfo = document.getElementById('fileInfo');
            const selectedFiles = document.getElementById('selectedFiles');
            const verifyButton = document.getElementById('verifyButton');
            
            if (fileInput.files.length > 0) {
                const file = fileInput.files[0];
                selectedFiles.innerHTML = `
                    <div class="selected-file">
                        <div class="file-details">
                            <div class="file-name">${file.name}</div>
                            <div class="file-size">${(file.size / 1024 / 1024).toFixed(2)} MB</div>
                        </div>
                    </div>`;
                fileInfo.style.display = 'block';
                verifyButton.disabled = false;
            } else {
                fileInfo.style.display = 'none';
                verifyButton.disabled = true;
            }
        }

        const verifyArea = document.getElementById('verifyArea');
        verifyArea.addEventListener('dragover', e => { e.preventDefault(); verifyArea.classList.add('dragover'); });
        verifyArea.addEventListener('dragleave', () => verifyArea.classList.remove('dragover'));
        verifyArea.addEventListener('drop', e => {
            e.preventDefault();
            verifyArea.classList.remove('dragover');
            const fileInput = document.getElementById('fileInput');
            fileInput.files = e.dataTransfer.files;
            displayFileInfo();
        });
    </script>
</body>
</html>
